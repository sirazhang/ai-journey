# MacBook 多任务并排窗口功能

## 功能描述
用户现在可以同时打开工作台（Workbench）和浏览器（Browser）应用，窗口并排显示，方便对照信息进行核验。

## 问题背景
**用户需求**：在 Company 场景中，用户需要同时查看工作台的信息核验界面和浏览器的搜索结果，以便对照确认信息。

**原有问题**：
- 所有窗口都居中显示（50% top, 50% left）
- 窗口完全重叠，无法同时查看
- 用户必须关闭一个应用才能看到另一个

## 解决方案

### 1. 窗口定位系统
创建 `getWindowPosition()` 函数，为每个应用分配独特的位置：

```javascript
const getWindowPosition = (id) => {
  const positions = {
    workbench: { top: '10%', left: '5%', width: '45%', height: '75%' },
    browser: { top: '10%', right: '5%', width: '45%', height: '75%' },
    maps: { top: '15%', left: '10%', width: '40%', height: '70%' },
    calendar: { top: '15%', right: '10%', width: '40%', height: '70%' }
  }
  return positions[id] || { ... }
}
```

### 2. 窗口布局

#### Workbench（工作台）
- **位置**：左侧
- **尺寸**：45% 宽度，75% 高度
- **定位**：top: 10%, left: 5%
- **用途**：信息核验，5 个验证类别

#### Browser（浏览器）
- **位置**：右侧
- **尺寸**：45% 宽度，75% 高度
- **定位**：top: 10%, right: 5%
- **用途**：Google 搜索，查找参考信息

#### Maps（地图）
- **位置**：左侧（略微偏下）
- **尺寸**：40% 宽度，70% 高度
- **定位**：top: 15%, left: 10%
- **用途**：Google Maps 位置验证

#### Calendar（日历）
- **位置**：右侧（略微偏下）
- **尺寸**：40% 宽度，70% 高度
- **定位**：top: 15%, right: 10%
- **用途**：任务管理和日程安排

### 3. 视觉反馈

#### 活动窗口（Active Window）
- **z-index**: 50
- **阴影**：`0 20px 60px rgba(0, 0, 0, 0.4)` - 深色强阴影
- **效果**：明显突出，表示当前焦点

#### 非活动窗口（Inactive Window）
- **z-index**: 10
- **阴影**：`0 10px 30px rgba(0, 0, 0, 0.2)` - 浅色弱阴影
- **效果**：略微后退，但仍然可见和可交互

### 4. 交互行为

#### 打开应用
1. 点击 Dock 图标或桌面图标
2. 如果应用未打开 → 打开并设为活动窗口
3. 如果应用已打开 → 切换为活动窗口（提升到前面）

#### 切换窗口
- 点击任意窗口 → 该窗口变为活动窗口
- z-index 和阴影自动更新
- 平滑过渡效果

#### 关闭应用
- 点击红色关闭按钮
- 窗口从 openApps 列表移除
- 如果关闭的是活动窗口 → 自动切换到上一个打开的窗口

## 使用场景

### 场景 1: 信息核验工作流
1. 用户打开 Workbench（默认已打开）
2. 看到需要验证的信息："某公司成立于 2015 年"
3. 点击 Browser 图标打开浏览器
4. 两个窗口并排显示
5. 在 Browser 中搜索公司信息
6. 对照搜索结果在 Workbench 中选择"真实"或"虚假"

### 场景 2: 位置验证
1. Workbench 显示："某地点位于北京市朝阳区"
2. 打开 Maps 应用
3. 在地图中搜索该地点
4. 对照地图结果进行验证

### 场景 3: 多应用协作
1. 同时打开 Workbench、Browser、Maps
2. 三个窗口各占一部分屏幕
3. 可以快速切换焦点
4. 所有信息一目了然

## 技术实现

### 修改的文件
- `src/components/MacBookInterface.jsx`

### 关键改动

#### 1. 移除固定居中定位
```javascript
// 修改前
window: {
  position: 'absolute',
  top: '50%',
  left: '50%',
  transform: 'translate(-50%, -50%)',
  width: '80%',
  height: '70%',
  // ...
}

// 修改后
window: {
  position: 'absolute',
  // 位置由 getWindowPosition() 动态提供
  // ...
}
```

#### 2. 添加位置计算函数
```javascript
const getWindowPosition = (id) => {
  const positions = {
    workbench: { top: '10%', left: '5%', width: '45%', height: '75%' },
    browser: { top: '10%', right: '5%', width: '45%', height: '75%' },
    // ...
  }
  return positions[id] || defaultPosition
}
```

#### 3. 更新 Window 组件
```javascript
const Window = ({ app }) => {
  const position = getWindowPosition(app.id)
  const isActive = activeApp === app.id
  
  return (
    <div style={{
      ...styles.window,
      ...position,  // 应用动态位置
      zIndex: getZIndex(app.id),
      boxShadow: isActive ? '强阴影' : '弱阴影'
    }}>
      {/* ... */}
    </div>
  )
}
```

## 优势

### 1. 提升工作效率
- 无需频繁切换窗口
- 信息对照更直观
- 减少记忆负担

### 2. 更真实的体验
- 模拟真实 MacOS 多任务
- 符合用户使用习惯
- 专业的界面设计

### 3. 灵活性
- 可以打开任意组合的应用
- 每个应用都有合理的位置
- 不会相互遮挡

### 4. 可扩展性
- 易于添加新应用
- 只需在 positions 对象中定义位置
- 自动处理 z-index 和阴影

## 视觉效果

### 布局示意图
```
┌─────────────────────────────────────────────────────┐
│  🍎 Workbench                          3:45 PM    × │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌──────────────────────┐  ┌──────────────────────┐│
│  │                      │  │                      ││
│  │   Workbench (45%)    │  │   Browser (45%)      ││
│  │                      │  │                      ││
│  │   信息核验界面        │  │   Google 搜索        ││
│  │                      │  │                      ││
│  │   [真实] [虚假]      │  │   搜索结果...        ││
│  │                      │  │                      ││
│  └──────────────────────┘  └──────────────────────┘│
│                                                     │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │  📄  🌐  📍  📅                              │   │
│  └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

### 窗口间距
- 左右窗口之间：10% 空隙（100% - 45% - 45% = 10%）
- 顶部边距：10%
- 侧边边距：5%
- 底部：Dock 占用空间

## 测试场景

### 测试 1: 基本并排显示
1. 打开 Workbench（默认打开）
2. 点击 Browser 图标
3. 验证：两个窗口并排显示，不重叠

### 测试 2: 窗口切换
1. 打开 Workbench 和 Browser
2. 点击 Workbench 窗口
3. 验证：Workbench 阴影变深，z-index 提升
4. 点击 Browser 窗口
5. 验证：Browser 阴影变深，Workbench 阴影变浅

### 测试 3: 关闭窗口
1. 打开 Workbench 和 Browser
2. 关闭 Browser
3. 验证：Workbench 自动成为活动窗口
4. 再次打开 Browser
5. 验证：Browser 出现在右侧正确位置

### 测试 4: 多窗口
1. 依次打开 Workbench、Browser、Maps
2. 验证：所有窗口都可见
3. 点击不同窗口
4. 验证：z-index 正确切换

## 未来改进

### 可能的增强功能
1. **窗口拖动**：允许用户拖动窗口到任意位置
2. **窗口调整大小**：允许用户调整窗口尺寸
3. **窗口最小化**：点击黄色按钮最小化到 Dock
4. **窗口最大化**：点击绿色按钮全屏显示
5. **记忆位置**：保存用户自定义的窗口位置
6. **快捷键**：Cmd+Tab 切换窗口

### 性能优化
1. 使用 CSS transform 代替 top/left（更好的性能）
2. 添加窗口动画（打开/关闭/切换）
3. 虚拟化非活动窗口内容（减少渲染）

## 总结

✅ **已实现**：
- 窗口并排显示
- Workbench 和 Browser 可同时打开
- 动态位置分配
- 活动窗口视觉反馈

🎯 **用户价值**：
- 提升信息核验效率
- 更好的多任务体验
- 符合真实工作流程

📊 **技术指标**：
- 代码改动：~30 行
- 性能影响：无明显影响
- 兼容性：完全向后兼容

---

**实现日期**：2026-02-07
**状态**：✅ 完成并测试
**文件**：`src/components/MacBookInterface.jsx`
